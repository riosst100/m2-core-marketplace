!function(a,b,c,d){"use strict";function H(b,c){g=a(b),this.element=b,this.settings=a.extend({},G,c),this._defaults=G,this._name=e,this.init()}var e="storeLocator";if("undefined"==typeof a.fn[e]&&"undefined"!=typeof google){var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y=[],z=[],A=[],B=[],C={},D={},E={},F={},G={waypoint:!1,color:"#DC143C",fontClass:"fa fa-map-marker",s_link:"",s_address2:"",s_address:"",s_city:"",s_country:"",s_image:"",s_lat:"",s_lng:"",s_name:"",s_telephone:"",s_website:"",s_zipcode:"",mapID:"bh-sl-map",locationList:"bh-sl-loc-list",formContainer:"bh-sl-form-container",formID:"bh-sl-user-location",addressID:"bh-sl-address",regionID:"bh-sl-region",mapSettings:{zoom:12,mapTypeId:google.maps.MapTypeId.ROADMAP},markerImg:null,markerDim:null,catMarkers:null,selectedMarkerImg:null,selectedMarkerImgDim:null,disableAlphaMarkers:!1,lengthUnit:"m",storeLimit:26,distanceAlert:60,dataType:"xml",dataLocation:"data/locations.xml",dataRaw:null,xmlElement:"marker",listColor1:"#ffffff",listColor2:"#eeeeee",originMarker:!1,originMarkerImg:null,originMarkerDim:null,bounceMarker:!0,slideMap:!0,modal:!1,overlay:"bh-sl-overlay",modalWindow:"bh-sl-modal-window",modalContent:"bh-sl-modal-content",closeIcon:"bh-sl-close-icon",defaultLoc:!1,defaultLat:null,defaultLng:null,autoComplete:!1,autoCompleteOptions:{},autoGeocode:!1,geocodeID:null,maxDistance:!1,maxDistanceID:"bh-sl-maxdistance",fullMapStart:!1,fullMapStartBlank:!1,fullMapStartListLimit:!1,noForm:!1,loading:!1,loadingContainer:"bh-sl-loading",featuredLocations:!1,pagination:!1,locationsPerPage:10,inlineDirections:!1,nameSearch:!1,searchID:"bh-sl-search",nameAttribute:"name",visibleMarkersList:!1,dragSearch:!1,infowindowTemplatePath:"js/plugins/storeLocator/templates/infowindow-description.html",listTemplatePath:"js/plugins/storeLocator/templates/location-list-description.html",KMLinfowindowTemplatePath:"js/plugins/storeLocator/templates/kml-infowindow-description.html",KMLlistTemplatePath:"js/plugins/storeLocator/templates/kml-location-list-description.html",listTemplateID:null,infowindowTemplateID:null,taxonomyFilters:null,taxonomyFiltersContainer:"bh-sl-filters-container",exclusiveFiltering:!1,querystringParams:!1,debug:!1,sessionStorage:!1,markerCluster:null,infoBubble:null,callbackNotify:null,callbackBeforeSend:null,callbackSuccess:null,callbackModalOpen:null,callbackModalReady:null,callbackModalClose:null,callbackJsonp:null,callbackCreateMarker:null,callbackPageChange:null,callbackDirectionsRequest:null,callbackCloseDirections:null,callbackNoResults:null,callbackListClick:null,callbackMarkerClick:null,callbackFilters:null,callbackMapSet:null,addressErrorAlert:"Unable to find address",autoGeocodeErrorAlert:"Automatic location detection failed. Please fill in your address or zip code.",distanceErrorAlert:"Unfortunately, our closest location is more than ",mileLang:"mile",milesLang:"miles",kilometerLang:"kilometer",kilometersLang:"kilometers",noResultsTitle:"No results",noResultsDesc:"No locations were found with the given criteria. Please modify your selections or input.",nextPage:"Next &raquo;",prevPage:"&laquo; Prev"};a.extend(H.prototype,{init:function(){var b=this;if(this.writeDebug("init"),this.settings.waypoint===!1){if("km"===this.settings.lengthUnit?E.EarthRadius=6367:E.EarthRadius=3956,j="kml"===this.settings.dataType?"xml":this.settings.dataType,this.settings.inlineDirections===!0&&a("."+this.settings.locationList).prepend('<div class="bh-sl-directions-panel"></div>'),m=this.settings.mapSettings.zoom,null!==this.settings.taxonomyFilters&&this.taxonomyFiltering(),this.settings.modal===!0&&(null!==this.settings.taxonomyFilters&&a("."+this.settings.taxonomyFiltersContainer).clone(!0,!0).prependTo(g),g.wrap('<div class="'+this.settings.overlay+'"><div class="'+this.settings.modalWindow+'"><div class="'+this.settings.modalContent+'">'),a("."+this.settings.modalWindow).prepend('<div class="'+this.settings.closeIcon+'"></div>'),a("."+this.settings.overlay).hide()),this.settings.autoComplete===!0){var d=c.getElementById(this.settings.addressID),e=new google.maps.places.Autocomplete(d,this.settings.autoCompleteOptions);this.settings.autoComplete===!0&&e.addListener("place_changed",function(a){b.processForm(a)})}this._loadTemplates()}else this._loadInfoTemplate(),b._waypoint()},_labelMarker:function(a,b,c){var d=this,e=new google.maps.LatLng(b,c),f=d.settings.color,g=d.settings.fontClass,h={path:"M 50 -119.876 -50 -119.876 -50 -19.876 -13.232 -19.876 0.199 0 13.63 -19.876 50 -19.876 Z",fillColor:f,fillOpacity:1,scale:.3,strokeColor:f,strokeWeight:0},i=new MarkerWithLabel({position:e,draggable:!1,raiseOnDrag:!1,map:a,animation:null,labelContent:"<span><i style='color:"+f+";' class='fa "+g+"'></i><span>",labelAnchor:new google.maps.Point(10,31),labelClass:"map-labels",labelStyle:{opacity:1},icon:h});B.push(i);var k=new google.maps.InfoWindow;d._createSingleInfowindow(i,k)},_setMapOnAll:function(a){for(var b=0;b<B.length;b++)B[b].setMap(a)},_loadInfoTemplate:function(){},_defineLocationDataSingle:function(b){this.writeDebug("_defineLocationDataSingle",arguments);var c={href:this.settings.s_link,name:this.settings.s_name,lat:this.settings.s_lat,lng:this.settings.s_lng,image:this.settings.s_image,address:this.settings.s_address,address2:this.settings.s_address2,city:this.settings.s_city,country:this.settings.s_country,zipcode:this.settings.s_zipcode,telephone:this.settings.s_telephone,website:this.settings.s_website};return{location:[a.extend(c,{markerid:"1",marker:"1"})]}},_createSingleInfowindow(b,c){this.writeDebug("_createSingleInfowindow",arguments);var d=this,e=this._defineLocationDataSingle(),f='<div class="store-content"><div class="tag-store"><img src="{{image}}" style="height:128px;width:128px"></div><div class="tag-content"><div class="loc-name"><a href="{{href}}" target="_blank">{{name}}</a></div><div>{{address}}</div><div>{{address2}}</div><div>{{city}}, {{country}} {{zipcode}}</div><div>{{telephone}}</div><div><a href="{{website}}" target="_blank">{{website}}</a></div></div></div>',g="";a.map(e.location,function(a){g+=d.replaceStr(f,a)}),google.maps.event.addListener(b,"click",function(){c.setContent(g),c.open(b.get("map"),b),b.get("map").panTo(b.getPosition()),b.get("map").setZoom(15)})},_geocodeLatLng:function(c,d){var e={lat:c,lng:d},f=new google.maps.Geocoder;f.geocode({location:e},function(c,d){"OK"===d?c[1]?a("#destination-input").val(c[1].formatted_address):b.alert("No results found"):b.alert("Geocoder failed due to: "+d)})},_geocodeAdress:function(c){geocoder.geocode({address:c},function(c,d){"OK"===d?c[1]?a("#destination-input").val(c[0].geometry.location):b.alert("No results found"):b.alert("Geocoder failed due to: "+d)})},_waypoint:function(){var b=this;b._geocodeLatLng(b.settings.defaultLat,b.settings.defaultLng);var d=null,e=null,f={lat:b.settings.defaultLat,lng:b.settings.defaultLng},g=new google.maps.DirectionsRenderer,h=new google.maps.DirectionsService,i=new google.maps.Map(c.getElementById("bh-sl-map"),{zoom:14,center:f});g.setMap(i),b._labelMarker(i,b.settings.defaultLat,b.settings.defaultLng),a("#destination-input").attr("readonly",!0),a("#destination-input").css("cursor","not-allowed"),a("#get_direction").on("click",function(){b._route(h,g)}),a(".swap-locations").on("click",function(){e=new google.maps.LatLng(b.settings.defaultLat,b.settings.defaultLng);if(a(this).hasClass("swap")){a(this).removeClass("swap"),a(this).addClass("unswap"),a("#destination-input").attr("readonly",!0),a("#destination-input").css("cursor","not-allowed"),a("#origin-input").attr("readonly",!1),a("#origin-input").css("cursor","pointer");var d=a("#destination-input").val(),f=a("#origin-input").val();a("#origin-input").val(d),a("#destination-input").val(f),b._route(h,g)}else{a(this).removeClass("unswap"),a(this).addClass("swap"),a("#origin-input").attr("readonly",!0),a("#origin-input").css("cursor","not-allowed"),a("#destination-input").attr("readonly",!1),a("#destination-input").css("cursor","pointer");var d=a("#destination-input").val(),f=a("#origin-input").val();a("#origin-input").val(d),a("#destination-input").val(f),b._route(h,g)}});var j="ul#mode li";a(j).on("click",function(){a(j).removeClass("active"),a(this).addClass("active"),b._route(h,g)});var k=c.getElementById("origin-input"),l=c.getElementById("destination-input"),m=new google.maps.places.Autocomplete(k);m.bindTo("bounds",i);var n=new google.maps.places.Autocomplete(l);n.bindTo("bounds",i),m.addListener("place_changed",function(){var a=m.getPlace();a.geometry&&(b._expand(i,a),d=new google.maps.LatLng(a.geometry.location.lat(),a.geometry.location.lng()),b._route(h,g))}),n.addListener("place_changed",function(){var a=n.getPlace();a.geometry&&(b._expand(i,a),e=new google.maps.LatLng(a.geometry.location.lat(),a.geometry.location.lng()),b._route(h,g))}),g.setPanel(c.getElementById("displaying-direction"))},_expand:function(a,b){b.geometry.viewport?a.fitBounds(b.geometry.viewport):(a.setCenter(b.geometry.location),a.setZoom(17))},_route:function(b,c){this.writeDebug("calculateAndDisplayRoute");var d=this;d._setMapOnAll(null);var e=a("ul#mode").find("li.active").data("traveling"),f=a("#origin-input").val(),g=a("#destination-input").val();f&&g&&b.route({origin:f,destination:g,travelMode:google.maps.TravelMode[e]},function(a,b){"OK"==b&&c.setDirections(a)})},destroy:function(){this.writeDebug("destroy"),this.reset();var b=a("#"+this.settings.mapID);if(B.length)for(var d=0;d<=B.length;d++)google.maps.event.removeListener(B[d]);a("."+this.settings.locationList+" ul").empty(),b.hasClass("bh-sl-map-open")&&b.empty().removeClass("bh-sl-map-open"),this.settings.modal===!0&&a(". "+this.settings.overlay).remove(),b.attr("style",""),g.hide(),a.removeData(g.get(0)),a(c).off(e),g.unbind()},reset:function(){if(this.writeDebug("reset"),z=[],y=[],A=[],B=[],x=!1,a(c).off("click."+e,"."+this.settings.locationList+" li"),a("."+this.settings.locationList+" .bh-sl-close-directions-container").length&&a(".bh-sl-close-directions-container").remove(),this.settings.inlineDirections===!0){var b=a("."+this.settings.locationList+" .adp");b.length>0&&(b.remove(),a("."+this.settings.locationList+" ul").fadeIn()),a(c).off("click","."+this.settings.locationList+" li .loc-directions a")}this.settings.pagination===!0&&a(c).off("click."+e,".bh-sl-pagination li")},formFiltersReset:function(){if(this.writeDebug("formFiltersReset"),null!==this.settings.taxonomyFilters){var b=a("."+this.settings.taxonomyFiltersContainer+" input"),c=a("."+this.settings.taxonomyFiltersContainer+" select");"object"==typeof b&&(b.each(function(){(a(this).is('input[type="checkbox"]')||a(this).is('input[type="radio"]'))&&a(this).prop("checked",!1)}),c.each(function(){a(this).prop("selectedIndex",0)}))}},mapReload:function(){this.writeDebug("mapReload"),this.reset();var b=a("#"+this.settings.addressID),c=a("#"+this.settings.searchID);(this.settings.nameSearch===!0&&""!==c.val()||""!==b.val())&&(c.val(""),b.val(""),this.processForm()),null!==this.settings.taxonomyFilters&&(this.formFiltersReset(),this.taxonomyFiltersInit()),q&&r?(this.settings.mapSettings.zoom=m,this.processForm()):this.mapping(F)},notify:function(a){this.writeDebug("notify",a),this.settings.callbackNotify&&this.settings.callbackNotify.call(this,a)},geoCodeCalcToRadian:function(a){return this.writeDebug("geoCodeCalcToRadian",a),a*(Math.PI/180)},geoCodeCalcDiffRadian:function(a,b){return this.writeDebug("geoCodeCalcDiffRadian",arguments),this.geoCodeCalcToRadian(b)-this.geoCodeCalcToRadian(a)},geoCodeCalcCalcDistance:function(a,b,c,d,e){return this.writeDebug("geoCodeCalcCalcDistance",arguments),2*e*Math.asin(Math.min(1,Math.sqrt(Math.pow(Math.sin(this.geoCodeCalcDiffRadian(a,c)/2),2)+Math.cos(this.geoCodeCalcToRadian(a))*Math.cos(this.geoCodeCalcToRadian(c))*Math.pow(Math.sin(this.geoCodeCalcDiffRadian(b,d)/2),2))))},getQueryString:function(a){if(this.writeDebug("getQueryString",a),a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b=new RegExp("[\\?&]"+a+"=([^&#]*)"),c=b.exec(location.search);return null===c?"":decodeURIComponent(c[1].replace(/\+/g," "))}},_loadTemplates:function(){this.writeDebug("_loadTemplates");var b,c=this,d='<div class="bh-sl-error">Error: Could not load plugin templates. Check the paths and ensure they have been uploaded. Paths will be wrong if you do not run this from a web server.</div>';"kml"===this.settings.dataType&&null===this.settings.listTemplateID&&null===this.settings.infowindowTemplateID?a.when(a.get(this.settings.KMLinfowindowTemplatePath,function(a){b=a,i=b}),a.get(this.settings.KMLlistTemplatePath,function(a){b=a,h=b})).then(function(){c.locator()},function(){throw a("."+c.settings.formContainer).append(d),new Error("Could not load storeLocator plugin templates")}):null!==this.settings.listTemplateID&&null!==this.settings.infowindowTemplateID?(i=a("#"+this.settings.infowindowTemplateID).html(),h=a("#"+this.settings.listTemplateID).html(),c.locator()):a.when(a.get(this.settings.infowindowTemplatePath,function(a){b=a,i=b}),a.get(this.settings.listTemplatePath,function(a){b=a,h=b})).then(function(){c.locator()},function(){throw a("."+c.settings.formContainer).append(d),new Error("Could not load storeLocator plugin templates")})},locator:function(){this.writeDebug("locator"),this.settings.slideMap===!0&&g.hide(),this._start(),this._formEventHandler()},_formEventHandler:function(){this.writeDebug("_formEventHandler");var b=this;this.settings.noForm===!0?(a(c).on("click."+e,"."+this.settings.formContainer+" button",function(a){b.processForm(a)}),a(c).on("keydown."+e,function(c){13===c.keyCode&&a("#"+b.settings.addressID).is(":focus")&&b.processForm(c)})):a(c).on("submit."+e,"#"+this.settings.formID,function(a){b.processForm(a)}),a(".bh-sl-reset").length&&a("#"+this.settings.mapID).length&&a(c).on("click."+e,".bh-sl-reset",function(){b.mapReload()})},_getData:function(b,c,d,e){this.writeDebug("_getData",arguments);var f=this,g="",h="",i="",k="";if("undefined"!=typeof e&&"undefined"!=typeof e.geometry.bounds&&(k=e.formatted_address,h=JSON.stringify(e.geometry.bounds.getNorthEast()),i=JSON.stringify(e.geometry.bounds.getSouthWest())),this.settings.callbackBeforeSend&&this.settings.callbackBeforeSend.call(this,b,c,d,k,h,i),null===f.settings.dataRaw){var l=a.Deferred();return this.settings.loading===!0&&a("."+this.settings.formContainer).append('<div class="'+this.settings.loadingContainer+'"></div>'),a.ajax({type:"GET",url:this.settings.dataLocation+("jsonp"===this.settings.dataType?(this.settings.dataLocation.match(/\?/)?"&":"?")+"callback=?":""),data:{name:g,origLat:b,origLng:c,origAddress:d,formattedAddress:k,boundsNorthEast:h,boundsSouthWest:i},dataType:j,jsonpCallback:"jsonp"===this.settings.dataType?this.settings.callbackJsonp:null}).done(function(b){l.resolve(b),f.settings.loading===!0&&a("."+f.settings.formContainer+" ."+f.settings.loadingContainer).remove()}).fail(l.reject),l.promise()}return"xml"===j?a.parseXML(f.settings.dataRaw):"json"===j?Array.isArray&&Array.isArray(f.settings.dataRaw)?f.settings.dataRaw:"string"==typeof f.settings.dataRaw?a.parseJSON(f.settings.dataRaw):[]:void 0},_start:function(){this.writeDebug("_start");var g,d=this,f=this.settings.autoGeocode;if(d.settings.fullMapStartBlank!==!1){var i=a("#"+d.settings.mapID);i.addClass("bh-sl-map-open");var j=d.settings.mapSettings;j.zoom=d.settings.fullMapStartBlank,g=new google.maps.LatLng(this.settings.defaultLat,this.settings.defaultLng),j.center=g;var k=new google.maps.Map(c.getElementById(d.settings.mapID),j);google.maps.event.addDomListener(b,"resize",function(){var a=k.getCenter();google.maps.event.trigger(k,"resize"),k.setCenter(a)}),d.settings.fullMapStartBlank=!1,j.zoom=m}else this.settings.defaultLoc===!0&&this.defaultLocation(),""!==a.trim(a("#"+this.settings.addressID).val())?(d.writeDebug("Using Address Field"),d.processForm(null),f=!1):this.settings.fullMapStart===!0&&(this.settings.querystringParams===!0&&this.getQueryString(this.settings.addressID)||this.settings.querystringParams===!0&&this.getQueryString(this.settings.searchID)||this.settings.querystringParams===!0&&this.getQueryString(this.settings.maxDistanceID)?(d.writeDebug("Using Query String"),this.processForm(null),f=!1):this.mapping(null)),this.settings.autoGeocode===!0&&f===!0&&(d.writeDebug("Auto Geo"),d.htmlGeocode()),null!==this.settings.autoGeocode&&(d.writeDebug("Button Geo"),a(c).on("click."+e,"#"+this.settings.geocodeID,function(){d.htmlGeocode()}))},htmlGeocode:function(){this.writeDebug("htmlGeocode",arguments);var a=this;return this.settings.sessionStorage===!0&&b.sessionStorage&&b.sessionStorage.getItem("myGeo")?(this.writeDebug("Using Session Saved Values for GEO"),this.autoGeocodeQuery(JSON.parse(b.sessionStorage.getItem("myGeo"))),!1):void(navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(c){a.writeDebug("Current Position Result");var d={coords:{latitude:c.coords.latitude,longitude:c.coords.longitude,accuracy:c.coords.accuracy}};a.settings.sessionStorage===!0&&b.sessionStorage&&b.sessionStorage.setItem("myGeo",JSON.stringify(d)),a.autoGeocodeQuery(d)},function(b){a._autoGeocodeError(b)}))},googleGeocode:function(a){a.writeDebug("googleGeocode",arguments);var c=new google.maps.Geocoder;this.geocode=function(a,b){c.geocode(a,function(a,c){if(c!==google.maps.GeocoderStatus.OK)throw b(null),new Error("Geocode was not successful for the following reason: "+c);var d={};d.latitude=a[0].geometry.location.lat(),d.longitude=a[0].geometry.location.lng(),d.geocodeResult=a[0],b(d)})}},reverseGoogleGeocode:function(a){a.writeDebug("reverseGoogleGeocode",arguments);var c=new google.maps.Geocoder;this.geocode=function(a,b){c.geocode(a,function(a,c){if(c===google.maps.GeocoderStatus.OK){if(a[0]){var d={};d.address=a[0].formatted_address,b(d)}}else b(null)})}},roundNumber:function(a,b){return this.writeDebug("roundNumber",arguments),Math.round(a*Math.pow(10,b))/Math.pow(10,b)},isEmptyObject:function(a){this.writeDebug("isEmptyObject",arguments);for(var b in a)if(a.hasOwnProperty(b))return!1;return!0},hasEmptyObjectVals:function(a){this.writeDebug("hasEmptyObjectVals",arguments);var b=!0;for(var c in a)a.hasOwnProperty(c)&&""!==a[c]&&0!==a[c].length&&(b=!1);return b},modalClose:function(){this.writeDebug("modalClose"),this.settings.callbackModalClose&&this.settings.callbackModalClose.call(this),C={},a("."+this.settings.overlay+" select").prop("selectedIndex",0),a("."+this.settings.overlay+" input").prop("checked",!1),a("."+this.settings.overlay).hide()},_createLocationVariables:function(a){this.writeDebug("_createLocationVariables",arguments);var b;D={};for(var c in z[a])z[a].hasOwnProperty(c)&&(b=z[a][c],"distance"===c&&(b=this.roundNumber(b,2)),D[c]=b)},sortNumerically:function(a){this.writeDebug("sortNumerically",arguments),a.sort(function(a,b){return a.distance<b.distance?-1:a.distance>b.distance?1:0})},filterData:function(a,b){this.writeDebug("filterData",arguments);var c=!0;for(var d in b)if(b.hasOwnProperty(d))if(this.settings.exclusiveFiltering===!0){for(var e=b[d],f=[],g=0;g<e.length;g++)f[g]=new RegExp(e[g],"i").test(a[d].replace(/[^\x00-\x7F]/g,""));f.indexOf(!0)===-1&&(c=!1)}else"undefined"!=typeof a[d]&&new RegExp(b[d].join(""),"i").test(a[d].replace(/[^\x00-\x7F]/g,""))||(c=!1);if(c)return!0},_paginationOutput:function(a,b){this.writeDebug("_paginationOutput",arguments),a=parseFloat(a);var c="",d=a+1,e=a-1;a>0&&(c+='<li class="bh-sl-next-prev" data-page="'+e+'">'+this.settings.prevPage+"</li>");for(var f=0;f<Math.ceil(b);f++){var g=f+1;c+=f===a?'<li class="bh-sl-current" data-page="'+f+'">'+g+"</li>":'<li data-page="'+f+'">'+g+"</li>"}return d<b&&(c+='<li class="bh-sl-next-prev" data-page="'+d+'">'+this.settings.nextPage+"</li>"),c},paginationSetup:function(b){this.writeDebug("paginationSetup",arguments);var d,c="",e=a(".bh-sl-pagination-container .bh-sl-pagination");d=this.settings.storeLimit===-1||z.length<this.settings.storeLimit?z.length/this.settings.locationsPerPage:this.settings.storeLimit/this.settings.locationsPerPage,"undefined"==typeof b&&(b=0),0===e.length?c=this._paginationOutput(b,d):(e.empty(),c=this._paginationOutput(b,d)),e.append(c)},markerImage:function(a,b,c){this.writeDebug("markerImage",arguments);var d;return d="undefined"!=typeof b&&"undefined"!=typeof c?{url:a,size:new google.maps.Size(b,c),scaledSize:new google.maps.Size(b,c)}:{url:a,size:new google.maps.Size(32,32),scaledSize:new google.maps.Size(32,32)}},createMarker:function(a,b,c,d,e,f,g,h){this.writeDebug("createMarker",arguments);var i,j,k,l=[];if(null!==this.settings.catMarkers&&"undefined"!=typeof f)if(f.indexOf(",")!==-1){l=f.split(",");for(var m=0;m<l.length;m++)l[m]in this.settings.catMarkers&&(j=this.markerImage(this.settings.catMarkers[l[m]][0],parseInt(this.settings.catMarkers[l[m]][1]),parseInt(this.settings.catMarkers[l[m]][2])))}else f in this.settings.catMarkers&&(j=this.markerImage(this.settings.catMarkers[f][0],parseInt(this.settings.catMarkers[f][1]),parseInt(this.settings.catMarkers[f][2])));if(null!==this.settings.markerImg&&(j=null===this.settings.markerDim?this.markerImage(this.settings.markerImg):this.markerImage(this.settings.markerImg,this.settings.markerDim.width,this.settings.markerDim.height)),this.settings.callbackCreateMarker)i=this.settings.callbackCreateMarker.call(this,e,a,d,f);else if(this.settings.disableAlphaMarkers===!0||this.settings.storeLimit===-1||this.settings.storeLimit>26||null!==this.settings.catMarkers||null!==this.settings.markerImg||this.settings.fullMapStart===!0&&x===!0&&(isNaN(this.settings.fullMapStartListLimit)||this.settings.fullMapStartListLimit>26||this.settings.fullMapStartListLimit===-1)){"undefined"!=typeof g&&"null"!==g||(g="#F59236"),"undefined"!=typeof h&&"null"!==g||(h="fa-map-marker");var n={path:"M 50 -119.876 -50 -119.876 -50 -19.876 -13.232 -19.876 0.199 0 13.63 -19.876 50 -19.876 Z",fillColor:g,fillOpacity:1,scale:.3,strokeColor:g,strokeWeight:0};i=new MarkerWithLabel({position:a,draggable:!1,raiseOnDrag:!1,map:e,animation:null,labelContent:"<span><i style='color:"+g+";' class='fa "+h+"'></i><span>",labelAnchor:new google.maps.Point(10,31),labelClass:"map-labels",labelStyle:{opacity:1},icon:n})}else k={url:"https://mt.googleapis.com/vt/icon/name=icons/spotlight/spotlight-waypoint-b.png&text="+d+"&psize=16&font=fonts/Roboto-Regular.ttf&color=ff333333&ax=44&ay=48"},i=new google.maps.Marker({position:a,map:e,icon:k,draggable:!1});return i},_defineLocationData:function(b,c,d){this.writeDebug("_defineLocationData",arguments);var e="";this._createLocationVariables(b.get("id"));var f;f=D.distance<=1?"km"===this.settings.lengthUnit?this.settings.kilometerLang:this.settings.mileLang:"km"===this.settings.lengthUnit?this.settings.kilometersLang:this.settings.milesLang;var g=b.get("id");return e=this.settings.disableAlphaMarkers===!0||this.settings.storeLimit===-1||this.settings.storeLimit>26||this.settings.fullMapStart===!0&&x===!0&&(isNaN(this.settings.fullMapStartListLimit)||this.settings.fullMapStartListLimit>26||this.settings.fullMapStartListLimit===-1)?g+1:d>0?String.fromCharCode("A".charCodeAt(0)+(c+g)):String.fromCharCode("A".charCodeAt(0)+g),{location:[a.extend(D,{markerid:g,marker:e,length:f,origin:k})]}},listSetup:function(b,c,d){var e=this;this.writeDebug("listSetup",arguments);var f=this._defineLocationData(b,c,d),g="";a.map(f.location,function(a){g+=e.replaceStr(h,a)}),a("."+this.settings.locationList+" ul").append(g)},replaceStr:function(a,b){for(var c=[b.marker,b.markerid,b.name,b.link,b.image,b.telephone,b.email,b.website,b.city,b.zipcode,b.address,b.address2,b.country,b.linkedin,b.facebook,b.twitter,b.youtube,b.vimeo,b.href,b.distance,b.length,b.lat,b.lng],d=["{{marker}}","{{markerid}}","{{name}}","{{link}}","{{image}}","{{telephone}}","{{email}}","{{website}}","{{city}}","{{zipcode}}","{{address}}","{{address2}}","{{country}}","{{linkedin}}","{{facebook}}","{{twitter}}","{{youtube}}","{{vimeo}}","{{href}}","{{distance}}","{{length}}","{{lat}}","{{lng}}"],e=0;e<d.length;e++)a=a.replace(new RegExp(d[e],"gi"),c[e]);return a},changeSelectedMarker:function(a){var b;"undefined"!=typeof w&&w.setIcon(v),b=null===this.settings.selectedMarkerImgDim?this.markerImage(this.settings.selectedMarkerImg):this.markerImage(this.settings.selectedMarkerImg,this.settings.selectedMarkerImgDim.width,this.settings.selectedMarkerImgDim.height),v=a.icon,a.setIcon(b),w=a},createInfowindow:function(b,c,d,e,f){this.writeDebug("createInfowindow",arguments);var g=this,h=this._defineLocationData(b,e,f),j="";a.map(h.location,function(a){j+=g.replaceStr(i,a)}),"left"===c?(d.setContent(j),d.open(b.get("map"),b)):google.maps.event.addListener(b,"click",function(){d.setContent(j),d.open(b.get("map"),b),b.get("map").panTo(b.getPosition()),b.get("map").setZoom(15);var c=b.get("id"),e=a("."+g.settings.locationList+" li[data-markerid="+c+"]");if(e.length>0){g.settings.callbackMarkerClick&&g.settings.callbackMarkerClick.call(this,b,c,e),a("."+g.settings.locationList+" li").removeClass("list-focus"),e.addClass("list-focus");var f=a("."+g.settings.locationList);f.animate({scrollTop:e.offset().top-f.offset().top+f.scrollTop()})}null!==g.settings.selectedMarkerImg&&g.changeSelectedMarker(b)})},autoGeocodeQuery:function(b){this.writeDebug("autoGeocodeQuery",arguments);var f,c=this,d=null,e=a("#"+this.settings.maxDistanceID);this.settings.querystringParams===!0&&this.getQueryString(this.settings.maxDistanceID)?(d=this.getQueryString(this.settings.maxDistanceID),""!==e.val()&&(d=e.val())):this.settings.maxDistance===!0&&(d=e.val()||"");var g=new this.reverseGoogleGeocode(this),h=new google.maps.LatLng(b.coords.latitude,b.coords.longitude);g.geocode({latLng:h},function(a){null!==a?(f=p=a.address,q=F.lat=b.coords.latitude,r=F.lng=b.coords.longitude,F.origin=f,F.distance=d,c.mapping(F)):c.notify(c.settings.addressErrorAlert)})},_autoGeocodeError:function(){this.writeDebug("_autoGeocodeError"),this.notify(this.settings.autoGeocodeErrorAlert)},defaultLocation:function(){this.writeDebug("defaultLocation");var e,b=this,c=null,d=a("#"+this.settings.maxDistanceID);this.settings.querystringParams===!0&&this.getQueryString(this.settings.maxDistanceID)?(c=this.getQueryString(this.settings.maxDistanceID),""!==d.val()&&(c=d.val())):this.settings.maxDistance===!0&&(c=d.val()||"");var f=new this.reverseGoogleGeocode(this),g=new google.maps.LatLng(this.settings.defaultLat,this.settings.defaultLng);f.geocode({latLng:g},function(a){null!==a?(e=p=a.address,q=F.lat=b.settings.defaultLat,r=F.lng=b.settings.defaultLng,F.distance=c,F.origin=e,b.mapping(F)):b.notify(b.settings.addressErrorAlert)})},paginationChange:function(a){this.writeDebug("paginationChange",arguments),this.settings.callbackPageChange&&this.settings.callbackPageChange.call(this,a),F.page=a,this.mapping(F)},getAddressByMarker:function(a){this.writeDebug("getAddressByMarker",arguments);var b="";return z[a].address&&(b+=z[a].address+" "),z[a].address2&&(b+=z[a].address2+" "),z[a].city&&(b+=z[a].city+", "),z[a].state&&(b+=z[a].state+" "),z[a].postal&&(b+=z[a].postal+" "),z[a].country&&(b+=z[a].country+" "),b},clearMarkers:function(){this.writeDebug("clearMarkers");var a=null;a=z.length<this.settings.storeLimit?z.length:this.settings.storeLimit;for(var b=0;b<a;b++)B[b].setMap(null)},directionsRequest:function(b,d,e){this.writeDebug("directionsRequest",arguments),this.settings.callbackDirectionsRequest&&this.settings.callbackDirectionsRequest.call(this,b,d,e);var f=this.getAddressByMarker(d);if(f){a("."+this.settings.locationList+" ul").hide(),this.clearMarkers(),null!==t&&"undefined"!=typeof t&&(t.setMap(null),t=null),t=new google.maps.DirectionsRenderer,u=new google.maps.DirectionsService,t.setMap(e),t.setPanel(a(".bh-sl-directions-panel").get(0));var g={origin:b,destination:f,travelMode:google.maps.TravelMode.DRIVING};u.route(g,function(a,b){b===google.maps.DirectionsStatus.OK&&t.setDirections(a)}),a("."+this.settings.locationList).prepend('<div class="bh-sl-close-directions-container"><div class="'+this.settings.closeIcon+'"></div></div>')}a(c).off("click","."+this.settings.locationList+" li .loc-directions a")},closeDirections:function(){this.writeDebug("closeDirections"),this.settings.callbackCloseDirections&&this.settings.callbackCloseDirections.call(this),this.reset(),q&&r&&(0===this.countFilters()?this.settings.mapSettings.zoom=m:this.settings.mapSettings.zoom=0,this.processForm(null)),a(c).off("click."+e,"."+this.settings.locationList+" .bh-sl-close-icon")},processForm:function(b){this.writeDebug("processForm",arguments);var c=this,d=null,e=a("#"+this.settings.addressID),f=a("#"+this.settings.searchID),g=a("#"+this.settings.maxDistanceID);"undefined"!=typeof b&&null!==b&&b.preventDefault(),this.settings.querystringParams===!0&&(this.getQueryString(this.settings.addressID)||this.getQueryString(this.settings.searchID)||this.getQueryString(this.settings.maxDistanceID))?(p=this.getQueryString(this.settings.addressID),o=this.getQueryString(this.settings.searchID),d=this.getQueryString(this.settings.maxDistanceID),""!==e.val()&&(p=e.val()),""!==f.val()&&(o=f.val()),""!==g.val()&&(d=g.val())):(p=e.val()||"",o=f.val()||"",this.settings.maxDistance===!0&&(d=g.val()||""));var h=a("#"+this.settings.regionID).val();if(""===p&&""===o)this._start();else if(""!==p)if("undefined"!=typeof k&&"undefined"!=typeof q&&"undefined"!=typeof r&&p===k)F.lat=q,F.lng=r,F.origin=p,F.name=o,F.distance=d,c.mapping(F);else{var i=new this.googleGeocode(this);i.geocode({address:p,region:h},function(a){null!==a?(q=a.latitude,r=a.longitude,F.lat=q,F.lng=r,F.origin=p,F.name=o,F.distance=d,F.geocodeResult=a.geocodeResult,c.mapping(F)):c.notify(c.settings.addressErrorAlert)})}else""!==o&&(F.name=o,c.mapping(F))},locationsSetup:function(a,b,c,d,e){if(this.writeDebug("locationsSetup",arguments),"undefined"!=typeof d&&(a.distance||(a.distance=this.geoCodeCalcCalcDistance(b,c,a.lat,a.lng,E.EarthRadius))),this.settings.maxDistance===!0&&"undefined"!=typeof e&&null!==e){if(!(a.distance<=e))return;z.push(a)}else if(this.settings.maxDistance===!0&&this.settings.querystringParams===!0&&"undefined"!=typeof e&&null!==e){if(!(a.distance<=e))return;z.push(a)}else z.push(a)},countFilters:function(){this.writeDebug("countFilters");var a=0;if(!this.isEmptyObject(C))for(var b in C)C.hasOwnProperty(b)&&(a+=C[b].length);return a},_existingCheckedFilters:function(b){this.writeDebug("_existingCheckedFilters",arguments),a("#"+this.settings.taxonomyFilters[b]+" input[type=checkbox]").each(function(){if(a(this).prop("checked")){var c=a(this).val();"undefined"!=typeof c&&""!==c&&C[b].indexOf(c)===-1&&C[b].push(c)}})},_existingSelectedFilters:function(b){this.writeDebug("_existingSelectedFilters",arguments),a("#"+this.settings.taxonomyFilters[b]+" select").each(function(){var c=a(this).val();"undefined"!=typeof c&&""!==c&&C[b].indexOf(c)===-1&&(C[b]=[c])})},_existingRadioFilters:function(b){this.writeDebug("_existingRadioFilters",arguments),a("#"+this.settings.taxonomyFilters[b]+" input[type=radio]").each(function(){if(a(this).prop("checked")){var c=a(this).val();"undefined"!=typeof c&&""!==c&&C[b].indexOf(c)===-1&&(C[b]=[c])}})},checkFilters:function(){this.writeDebug("checkFilters");for(var a in this.settings.taxonomyFilters)this.settings.taxonomyFilters.hasOwnProperty(a)&&(this._existingCheckedFilters(a),this._existingSelectedFilters(a),this._existingRadioFilters(a))},checkQueryStringFilters:function(){this.writeDebug("checkQueryStringFilters",arguments);for(var a in C)if(C.hasOwnProperty(a)){var b=this.getQueryString(a);"undefined"!=typeof b&&""!==b&&C[a].indexOf(b)===-1&&(C[a]=[b])}},getFilterKey:function(a){this.writeDebug("getFilterKey",arguments);for(var b in this.settings.taxonomyFilters)if(this.settings.taxonomyFilters.hasOwnProperty(b))for(var c=0;c<this.settings.taxonomyFilters[b].length;c++)if(this.settings.taxonomyFilters[b]===a)return b},taxonomyFiltersInit:function(){this.writeDebug("taxonomyFiltersInit");for(var a in this.settings.taxonomyFilters)this.settings.taxonomyFilters.hasOwnProperty(a)&&(C[a]=[]);
},taxonomyFiltering:function(){this.writeDebug("taxonomyFiltering");var b=this;b.taxonomyFiltersInit(),b.checkQueryStringFilters(),a("."+this.settings.taxonomyFiltersContainer).on("change."+e,"input, select",function(c){c.stopPropagation();var d,e,f;if(a(this).is('input[type="checkbox"]')){if(b.checkFilters(),d=a(this).val(),e=a(this).closest(".bh-sl-filters").attr("id"),f=b.getFilterKey(e))if(a(this).prop("checked"))C[f].indexOf(d)===-1&&C[f].push(d),a("#"+b.settings.mapID).hasClass("bh-sl-map-open")===!0&&(q&&r?(b.settings.mapSettings.zoom=0,b.processForm()):b.mapping(F));else{var g=C[f].indexOf(d);g>-1&&(C[f].splice(g,1),a("#"+b.settings.mapID).hasClass("bh-sl-map-open")===!0&&(q&&r?(0===b.countFilters()?b.settings.mapSettings.zoom=m:b.settings.mapSettings.zoom=0,b.processForm()):b.mapping(F)))}}else(a(this).is("select")||a(this).is('input[type="radio"]'))&&(b.checkFilters(),d=a(this).val(),e=a(this).closest(".bh-sl-filters").attr("id"),f=b.getFilterKey(e),d?f&&(C[f]=[d],a("#"+b.settings.mapID).hasClass("bh-sl-map-open")===!0&&(q&&r?(b.settings.mapSettings.zoom=0,b.processForm()):b.mapping(F))):(f&&(C[f]=[]),b.reset(),q&&r?(b.settings.mapSettings.zoom=m,b.processForm()):b.mapping(F)))})},checkVisibleMarkers:function(b,c){this.writeDebug("checkVisibleMarkers",arguments);var e,f,d=this;a("."+this.settings.locationList+" ul").empty(),a(b).each(function(b,g){c.getBounds().contains(g.getPosition())&&(d.listSetup(g,0,0),f=h(e),a("."+d.settings.locationList+" ul").append(f))}),a("."+this.settings.locationList+" ul li:even").css("background",this.settings.listColor1),a("."+this.settings.locationList+" ul li:odd").css("background",this.settings.listColor2)},dragSearch:function(a){this.writeDebug("dragSearch",arguments);var c,b=a.getCenter(),d=this;this.settings.mapSettings.zoom=a.getZoom(),q=F.lat=b.lat(),r=F.lng=b.lng();var e=new this.reverseGoogleGeocode(this);c=new google.maps.LatLng(F.lat,F.lng),e.geocode({latLng:c},function(a){null!==a?(F.origin=p=a.address,d.mapping(F)):d.notify(d.settings.addressErrorAlert)})},emptyResult:function(){this.writeDebug("emptyResult",arguments);var b=a(".bh-sl-pagination-container .bh-sl-pagination");b.empty();var d=a(".bh-sl-total-results");d.text(0);var e,h,f=a("."+this.settings.locationList+" ul"),g=this.settings.mapSettings,i=new google.maps.Map(c.getElementById(this.settings.mapID),g);this.settings.callbackNoResults&&this.settings.callbackNoResults.call(this,i,g),f.empty(),h=a('<li><div class="bh-sl-noresults-title">'+this.settings.noResultsTitle+'</div><br><div class="bh-sl-noresults-desc">'+this.settings.noResultsDesc+"</li>").hide().fadeIn(),f.append(h),e=q&&r?new google.maps.LatLng(q,r):new google.maps.LatLng(0,0),i.setCenter(e),m&&i.setZoom(m)},originMarker:function(a,b,c){if(this.writeDebug("originMarker",arguments),this.settings.originMarker===!0){var d,e="";"undefined"!=typeof b&&(e=null!==this.settings.originMarkerImg?null===this.settings.originMarkerDim?this.markerImage(this.settings.originMarkerImg):this.markerImage(this.settings.originMarkerImg,this.settings.originMarkerDim.width,this.settings.originMarkerDim.height):{url:"https://mt.googleapis.com/vt/icon/name=icons/spotlight/spotlight-waypoint-a.png"},d=new google.maps.Marker({position:c,map:a,icon:e,draggable:!1}))}},modalWindow:function(){if(this.writeDebug("modalWindow"),this.settings.modal===!0){var b=this;b.settings.callbackModalOpen&&b.settings.callbackModalOpen.call(this),a("."+b.settings.overlay).fadeIn(),a(c).on("click."+e,"."+b.settings.closeIcon+", ."+b.settings.overlay,function(){b.modalClose()}),a(c).on("click."+e,"."+b.settings.modalWindow,function(a){a.stopPropagation()}),a(c).on("keyup."+e,function(a){27===a.keyCode&&b.modalClose()})}},listClick:function(b,d,f,g){this.writeDebug("listClick",arguments);var h=this;a(c).on("click."+e,"."+h.settings.locationList+" li",function(){var c=a(this).data("markerid"),e=B[c];h.settings.callbackListClick&&h.settings.callbackListClick.call(this,c,e),b.panTo(e.getPosition()),b.setZoom(15);var i="left";h.settings.bounceMarker===!0?(e.setAnimation(null),setTimeout(function(){e.setAnimation(null),h.createInfowindow(e,i,d,f,g)},700)):h.createInfowindow(e,i,d,f,g),null!==h.settings.selectedMarkerImg&&h.changeSelectedMarker(e),a("."+h.settings.locationList+" li").removeClass("list-focus"),a("."+h.settings.locationList+" li[data-markerid="+c+"]").addClass("list-focus")}),a(c).on("click."+e,"."+h.settings.locationList+" li a",function(a){a.stopPropagation()})},resultsTotalCount:function(b){this.writeDebug("resultsTotalCount",arguments);var c=a(".bh-sl-total-results");"undefined"==typeof b||b<=0||0===c.length||c.text(b)},inlineDirections:function(b,d){if(this.writeDebug("inlineDirections",arguments),this.settings.inlineDirections===!0&&"undefined"!=typeof d){var f=this;a(c).on("click."+e,"."+f.settings.locationList+" li .loc-directions a",function(g){g.preventDefault();var h=a(this).closest("li").attr("data-markerid");f.directionsRequest(d,h,b),a(c).on("click."+e,"."+f.settings.locationList+" .bh-sl-close-icon",function(){f.closeDirections()})})}},visibleMarkersList:function(a,b){if(this.writeDebug("visibleMarkersList",arguments),this.settings.visibleMarkersList===!0){var c=this;google.maps.event.addListenerOnce(a,"idle",function(){c.checkVisibleMarkers(b,a)}),google.maps.event.addListener(a,"center_changed",function(){c.checkVisibleMarkers(b,a)}),google.maps.event.addListener(a,"zoom_changed",function(){c.checkVisibleMarkers(b,a)})}},mapping:function(a){this.writeDebug("mapping",arguments);var c,d,e,f,g,h,b=this;this.isEmptyObject(a)||(c=a.lat,d=a.lng,e=a.geocodeResult,f=a.origin,h=a.page),b.settings.pagination===!0&&("undefined"!=typeof h&&k===p||(h=0)),"undefined"==typeof f&&this.settings.nameSearch===!0?n=b._getData():(g=new google.maps.LatLng(c,d),"undefined"!=typeof k&&f===k&&"undefined"!=typeof l?(f=k,n=l):n=b._getData(q,r,f,e)),null!==b.settings.taxonomyFilters&&b.hasEmptyObjectVals(C)&&b.checkFilters(),null!==b.settings.dataRaw?b.processData(a,g,n,h):n.done(function(c){b.processData(a,g,c,h)})},processData:function(d,f,h,i){this.writeDebug("processData",arguments);var q,r,t,u,v,w,D,E,F,G,H,I,J,j=this,p=0,K={};this.isEmptyObject(d)||(q=d.lat,r=d.lng,t=d.origin,u=d.name,v=d.distance);var L=a("#"+j.settings.mapID),M="km"===j.settings.lengthUnit?j.settings.kilometersLang:j.settings.milesLang;if(l=n,"undefined"!=typeof t&&(k=t),j.settings.callbackSuccess&&j.settings.callbackSuccess.call(this),I=L.hasClass("bh-sl-map-open"),j.settings.fullMapStart===!0&&I===!1||j.settings.autoGeocode===!0&&I===!1||j.settings.defaultLoc===!0&&I===!1?x=!0:j.reset(),L.addClass("bh-sl-map-open"),"json"===j.settings.dataType||"jsonp"===j.settings.dataType)for(var N=0;p<h.length;N++){var O=h[N],P={};for(var Q in O)O.hasOwnProperty(Q)&&(P[Q]=O[Q]);j.locationsSetup(P,q,r,t,v),p++}else"kml"===j.settings.dataType?a(h).find("Placemark").each(function(){var b={name:a(this).find("name").text(),lat:a(this).find("coordinates").text().split(",")[1],lng:a(this).find("coordinates").text().split(",")[0],description:a(this).find("description").text()};j.locationsSetup(b,q,r,t,v),p++}):a(h).find(j.settings.xmlElement).each(function(){var a={};for(var b in this.attributes)this.attributes.hasOwnProperty(b)&&(a[this.attributes[b].name]=this.attributes[b].value);j.locationsSetup(a,q,r,t,v),p++});if(j.settings.nameSearch===!0&&"undefined"!=typeof o&&(C[j.settings.nameAttribute]=[o]),null!==j.settings.taxonomyFilters||j.settings.nameSearch===!0){for(var R in C)if(C.hasOwnProperty(R)&&C[R].length>0)for(var S=0;S<C[R].length;S++)K[R]||(K[R]=[]),K[R][S]="(?=.*\\b"+C[R][S].replace(/([^\x00-\x7F]|[.*+?^=!:${}()|\[\]\/\\])/g,"")+"\\b)";j.isEmptyObject(K)||(z=a.grep(z,function(a){return j.filterData(a,K)}))}if("undefined"!=typeof t&&j.sortNumerically(z),j.settings.featuredLocations===!0&&(y=a.grep(z,function(a){return"true"===a.featured}),A=a.grep(z,function(a){return"true"!==a.featured}),z=[],z=y.concat(A)),j.isEmptyObject(K))if(j.settings.maxDistance===!0&&v)("undefined"==typeof z[0]||z[0].distance>v)&&j.notify(j.settings.distanceErrorAlert+v+" "+M);else{if("undefined"==typeof z[0])throw new Error("No locations found. Please check the dataLocation setting and path.");j.settings.distanceAlert!==-1&&z[0].distance>j.settings.distanceAlert&&(j.notify(j.settings.distanceErrorAlert+j.settings.distanceAlert+" "+M),H=!0)}if(j.settings.slideMap===!0&&g.slideDown(),j.isEmptyObject(z)||"none"===z[0].result)return void j.emptyResult();if(j.settings.pagination===!0&&j.paginationSetup(i),j.modalWindow(),s=j.settings.storeLimit===-1||z.length<j.settings.storeLimit||this.settings.fullMapStart===!0&&x===!0&&(isNaN(this.settings.fullMapStartListLimit)||this.settings.fullMapStartListLimit>26||this.settings.fullMapStartListLimit===-1)?z.length:j.settings.storeLimit,j.settings.pagination===!0?(F=j.settings.locationsPerPage,E=i*j.settings.locationsPerPage,E+F>z.length&&(F=j.settings.locationsPerPage-(E+F-z.length)),z=z.slice(E,E+F),s=z.length):(F=s,E=0),j.resultsTotalCount(z.length),j.settings.fullMapStart===!0&&x===!0||0===j.settings.mapSettings.zoom||"undefined"==typeof t||H===!0)G=j.settings.mapSettings,D=new google.maps.LatLngBounds;else if(j.settings.pagination===!0){var T=new google.maps.LatLng(z[0].lat,z[0].lng);0===i?(j.settings.mapSettings.center=f,G=j.settings.mapSettings):(j.settings.mapSettings.center=T,G=j.settings.mapSettings)}else j.settings.mapSettings.center=f,G=j.settings.mapSettings;var U=new google.maps.Map(c.getElementById(j.settings.mapID),G);if(google.maps.event.addDomListener(b,"resize",function(){var a=U.getCenter();google.maps.event.trigger(U,"resize"),U.setCenter(a)}),j.settings.dragSearch===!0&&U.addListener("dragend",function(){j.dragSearch(U)}),g.data(j.settings.mapID.replace("#",""),U),j.settings.callbackMapSet&&j.settings.callbackMapSet.call(this,U,f,m,G),"undefined"!=typeof InfoBubble&&null!==j.settings.infoBubble){var V=j.settings.infoBubble;V.map=U,J=new InfoBubble(V)}else J=new google.maps.InfoWindow;j.originMarker(t,f,U),a(c).on("click."+e,".bh-sl-pagination li",function(b){b.preventDefault(),j.paginationChange(a(this).attr("data-page"))}),j.inlineDirections(U,t);for(var W=0;W<=F-1;W++){var X="";X=i>0?String.fromCharCode("A".charCodeAt(0)+(E+W)):String.fromCharCode("A".charCodeAt(0)+W);var Y=new google.maps.LatLng(z[W].lat,z[W].lng);w=j.createMarker(Y,z[W].name,z[W].address,X,U,z[W].category,z[W].color,z[W].fontClass),w.set("id",W),B[W]=w,(j.settings.fullMapStart===!0&&x===!0||0===j.settings.mapSettings.zoom||"undefined"==typeof t||H===!0)&&D.extend(Y),j.createInfowindow(w,null,J,E,i)}(j.settings.fullMapStart===!0&&x===!0||0===j.settings.mapSettings.zoom||"undefined"==typeof t||H===!0)&&U.fitBounds(D);var Z=a("."+j.settings.locationList+" ul");if(Z.empty(),x&&j.settings.fullMapStartListLimit!==!1&&!isNaN(j.settings.fullMapStartListLimit)&&j.settings.fullMapStartListLimit!==-1)for(var $=0;$<j.settings.fullMapStartListLimit;$++){var _=B[$];j.listSetup(_,E,i)}else a(B).each(function(a){var b=B[a];j.listSetup(b,E,i)});if("undefined"!=typeof MarkerClusterer&&null!==j.settings.markerCluster){new MarkerClusterer(U,B,j.settings.markerCluster)}j.listClick(U,J,E,i),a("."+j.settings.locationList+" ul > li:even").css("background",j.settings.listColor1),a("."+j.settings.locationList+" ul > li:odd").css("background",j.settings.listColor2),j.visibleMarkersList(U,B),j.settings.modal===!0&&j.settings.callbackModalReady&&j.settings.callbackModalReady.call(this),j.settings.callbackFilters&&j.settings.callbackFilters.call(this,C)},writeDebug:function(){b.console&&this.settings.debug&&(Function.prototype.bind?this.writeDebug=Function.prototype.bind.call(console.log,console,"StoreLocator :"):this.writeDebug=function(){arguments[0]="StoreLocator : "+arguments[0],Function.prototype.apply.call(console.log,console,arguments)},this.writeDebug.apply(this,arguments))}}),a.fn[e]=function(b){var c=arguments;if(b===d||"object"==typeof b)return this.each(function(){a.data(this,"plugin_"+e)||a.data(this,"plugin_"+e,new H(this,b))});if("string"==typeof b&&"_"!==b[0]&&"init"!==b){var f;return this.each(function(){var d=a.data(this,"plugin_"+e);d instanceof H&&"function"==typeof d[b]&&(f=d[b].apply(d,Array.prototype.slice.call(c,1))),"destroy"===b&&a.data(this,"plugin_"+e,null)}),f!==d?f:this}}}}(jQuery,window,document);